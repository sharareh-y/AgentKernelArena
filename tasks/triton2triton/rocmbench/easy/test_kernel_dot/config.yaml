compile_command:
- python -c "import ast; ast.parse(open('test_kernel_dot.py').read())"
correctness_command:
- pytest -vv -x --maxfail=1 test_kernel_dot.py -k "not test_performance and not test_save_performance_results"
performance_command:
- pytest -vv -x --maxfail=1 test_kernel_dot.py -k "test_performance or test_save_performance_results"
task_type: triton2triton
task_result_template: null
prompt:
  cheatsheet: null
  instructions: "\nYou are an expert in triton programming language. You will be given\
    \ the function definition for the `kernel_dot`. Your task is to complete the kernel\
    \ code. Only optimize the kernel code in the function definition, DONT remove\
    \ any python imports or helper utils in the instruction/code provided, DONT change/interfere\
    \ with the provided function definition and parameter list.\n\nThis kernel, `kernel_dot`,\
    \  performs a in-place dot product (matrix multiplication)\n\n**Your objective\
    \ is to optimize the body of `kernel_dot`.**\n\nYou must ensure that:\n1.  All\
    \ arguments received by `kernel_dot` are kept intact and not modified.\n2. Provide\
    \ you final code in ```python code block. \nExample:\n```python\n<YOUR-CODE-HERE>\n\
    ```\nThe full definition for `kernel_dot` and relevant helper utilities are provided\
    \ in the context below. You only need to optimize the code for `kernel_dot` whilst\
    \ keeping other things intact. DONT remove Imports and HELPER utils.\n\n########################################\
    \ Imports ########################################\nimport multiprocessing\nimport\
    \ shutil\nimport tempfile\nimport os\nimport pytest\n\nimport triton\nimport triton.language\
    \ as tl\nfrom triton.backends.compiler import AttrsDescriptor\nfrom triton.compiler\
    \ import ASTSource\n######################################## Imports ########################################\n\
    \n\n@triton.jit\ndef kernel_dot(Z):\n    \"\"\"\n    This Triton kernel performs\
    \ an in-place dot product (matrix multiplication)\n    of a 16x16 block of a given\
    \ tensor Z with itself.\n\n    Parameters\n    ----------\n    Z : tl.tensor (pointer)\n\
    \        A Triton tensor pointer representing a 2D matrix.\n        The kernel\
    \ will load a 16x16 block from this tensor,\n        compute its dot product with\
    \ itself (i.e., block @ block),\n        and store the result back into the same\
    \ location in Z.\n        This tensor serves as both input and output.\n    \"\
    \"\"\n    # Your code here\n\n"
  source_code: null
source_file_path:
- test_kernel_dot.py
target_kernel_functions:
- kernel_dot
