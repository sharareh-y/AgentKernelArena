source_file_path:
  - source/triton_num_nans.py

target_kernel_functions:
  - _num_nans_kernel

compile_command:
  - python3 scripts/task_runner.py compile

correctness_command:
  - python3 scripts/task_runner.py correctness

performance_command:
  - python3 scripts/task_runner.py performance

task_type: triton2triton

task_result_template: null

prompt:
  source_code: null
  instructions: |
    Optimize the Triton kernel `_num_nans_kernel` for maximum GPU throughput
    while maintaining correctness.

    The kernel counts the number of NaN values in each row of a 2D logits tensor.
    It iterates over the vocabulary dimension in blocks, converts to float32,
    checks for NaN using libdevice.isnan, and accumulates the count.

    Key optimization opportunities:
    - Block size tuning for the vocabulary scan
    - Efficient reduction of NaN counts
    - Minimizing float32 conversions
    - Vectorized loads

    Constraints:
    - Must maintain the same function signature for `get_num_nans`
    - Output must match reference exactly (integer NaN counts)
  cheatsheet: null
