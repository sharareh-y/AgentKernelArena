compile_command:
- python fifth_order_sph_harmonics.py
correctness_command:
- python fifth_order_sph_harmonics_perf.py
performance_command:
- tb_eval -f fifth_order_sph_harmonics.py -o fifth_order_sph_harmonics_output.json
  -run_on_code -ds tbg
task_type: instruction2triton
task_result_template: null
prompt:
  cheatsheet: null
  instructions: "You are a expert in writing Triton operators for efficient GPU programming.\
    \ Use triton language write a kernel and wrapper according following instruction.\n\
    \    This code defines Triton kernels and a PyTorch autograd function for computing\
    \ fifth-order spherical harmonics. The `fifth_order_fwd` kernel computes the spherical\
    \ harmonics projections using x, y, z coordinates, defined with various constants\
    \ for the harmonic orders. Inputs include a coordinate tensor, output buffer,\
    \ block size, number of elements, and other configuration parameters. The output\
    \ consists of harmonics in different orders computed using mathematical operations\
    \ on x, y, z. The `fifth_order_bwd` kernel calculates gradients for these harmonics,\
    \ using pre-calculated derivatives and loading gradients from the output space.\
    \ Each kernel handles blocks of work determined by block size, calculated via\
    \ a helper function. The `FifthOrderSphericalHarmonic` class is a PyTorch function\
    \ managing these kernels' forward and backward execution. It initializes outputs,\
    \ saves context for backpropagation, and allocates memory as needed. The code\
    \ applies Triton's parallel capabilities to process tensor computations efficiently,\
    \ aimed at GPU utilization. \n    \nThe test code is:\n\n\n# Test case to compare\
    \ Triton implementations\ndef test_fifth_order_spherical_harmonic():\n    # Generate\
    \ random input coordinates\n    coords = torch.randn(128, 3, device='cuda', dtype=torch.float32)\n\
    \n    # Triton implementation\n    triton_output = FifthOrderSphericalHarmonic.apply(coords)\n\
    \n    # Test for various block sizes and offsets\n    test_cases = {}\n    for\
    \ i, (block_size, col_offset) in enumerate([(64, 0), (32, 1), (128, 2), (256,\
    \ 3)], start=1):\n        # \u5C06\u5173\u952E\u5B57\u53C2\u6570\u6539\u4E3A\u4F4D\
    \u7F6E\u53C2\u6570\n        triton_output = FifthOrderSphericalHarmonic.apply(coords,\
    \ None, None, block_size, col_offset)\n        test_cases[f'test_case_{i}'] =\
    \ triton_output\n\n    return test_cases\n\n# Run the test\nresult_gold = test_fifth_order_spherical_harmonic()\n\
    \n\nDon't append test code to the kernel code or edit test function.\n\nThe generated\
    \ code should be written into a python file.\nIf you have already created a file\
    \ and wrote the code into it, edit the code directly in the file.\nTest the code\
    \ by running `python python_bindings/tritonbench.py fifth_order_sph_harmonics.py\
    \ {kernel_path}` to check the correctness and performance.The kernel_path is where\
    \ you stored the generated code.\nCall Status means whether the code can be executed,\
    \ Exec Status means whether the code is functionally correct.\n"
  source_code: null
source_file_path:
- null
target_kernel_functions:
- fifth_order_sph_harmonics
